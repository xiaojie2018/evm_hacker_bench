 import hashlib
import sys

def keccak256(data):
    return hashlib.sha3_256(data).hexdigest()

# Function signature from POC: need to compute selector for proxyTransfer
function_sig = "proxyTransfer(address,address,uint256,address)"
print(f"Function signature: {function_sig}")

# Compute keccak256 hash
hash_bytes = hashlib.sha3_256(function_sig.encode()).digest()
print(f"Keccak256 hash (full): {hash_bytes.hex()}")

# First 4 bytes is the function selector
selector = hash_bytes[:4].hex()
print(f"Function selector (first 4 bytes): 0x{selector}")

# Check if it matches 0xec22f4c7
target_selector = "0xec22f4c7"
print(f"Target selector from POC: {target_selector}")
print(f"Match: {'YES' if f'0x{selector}' == target_selector else 'NO'}")