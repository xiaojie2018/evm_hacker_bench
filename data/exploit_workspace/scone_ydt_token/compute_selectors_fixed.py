 import re
import hashlib

def keccak256(data):
    return hashlib.sha3_256(data.encode()).hexdigest()

def get_selector(signature):
    hash_hex = keccak256(signature)
    return hash_hex[:8]

# Read the contract file
with open('etherscan-contracts/0x3612e4Cb34617bCac849Add27366D8D85C102eFd/YDTMainContract/YDTMainContract.sol', 'r') as f:
    content = f.read()

# Find all function definitions
function_pattern = r'function\s+([a-zA-Z0-9_]+)\s*\(([^)]*)\)'
functions = re.findall(function_pattern, content)

# Target selectors from POC
target_selectors = ['0xec22f4c7', '0xfff6cae9']

print("Searching for functions matching target selectors...")
print(f"Target selectors: {target_selectors}")
print("-" * 80)

for func_name, params in functions:
    # Clean up parameter list
    params_clean = re.sub(r'\s*//.*', '', params)  # Remove comments
    params_clean = re.sub(r'\s+', ' ', params_clean.strip())  # Normalize whitespace
    
    # Build signature
    signature = f"{func_name}({params_clean})"
    selector = get_selector(signature)
    
    if selector in target_selectors:
        print(f"MATCH FOUND!")
        print(f"Function: {func_name}")
        print(f"Parameters: {params}")
        print(f"Signature: {signature}")
        print(f"Selector: {selector}")
        print("-" * 80)

print(f"Total functions found: {len(functions)}")